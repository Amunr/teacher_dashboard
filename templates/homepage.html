{% extends "layout.html" %}

{% block title %}Student Assessment Dashboard{% endblock %}

{% block content %}
<!-- Filters Section -->
<div class="row mb-5">
    <div class="col-12">
        <div class="row g-4">
            {% for label, id, placeholder in [
                ("School", "schoolFilter", "Type to search schools..."),
                ("Grade", "gradeFilter", "Type to search grades..."),
                ("Assessment", "assessmentFilter", "Type to search assessments..."),
                ("Domain", "domainFilter", "Type to search domains...")
            ] %}
            <div class="col-md-3 col-sm-6">
                <label for="{{ id }}" class="form-label fw-bold">{{ label }}:</label>
                <div class="position-relative">
                    <input type="text" class="form-control form-control-lg border-warning border-3 rounded-4" id="{{ id }}" placeholder="{{ placeholder }}" autocomplete="off">
                    <div class="dropdown-menu w-100 border-2 rounded-3 shadow-lg" id="{{ id | replace('Filter', 'Dropdown') }}" style="max-height: 200px; overflow-y: auto;"></div>
                    <input type="hidden" id="selected{{ label }}" name="selected{{ label }}">
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- School Readiness Section -->
<div class="row mb-5">
    <div class="col-12">
        <div class="card border-warning border-3 rounded-4 shadow-lg">
            <div class="card-body p-5">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h4 class="card-title fw-bold">
                            <span id="readinessPercentage">75</span>% children who are school ready
                        </h4>
                    </div>
                    <div class="col-md-4 text-center">
                        <div class="position-relative d-inline-block">
                            <canvas id="readinessGauge" width="120" height="80"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Key Metrics Section -->
<div class="row mb-5">
    {% for title, id, color, value in [
        ("A Total Students", "totalStudents", "primary", 150),
        ("B Students assessed", "studentsAssessed", "success", 142),
        ("C Class avg. score", "classAvgScore", "info", "78%")
    ] %}
    <div class="col-md-4 mb-4">
        <div class="card border-dark border-3 rounded-4 shadow-lg h-100">
            <div class="card-body p-4 text-center">
                <h6 class="card-title fw-bold mb-3">{{ title }}</h6>
                <h2 class="text-{{ color }} fw-bold display-6" id="{{ id }}">{{ value }}</h2>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Skills Overview Section -->
<div class="row mb-5">
    <div class="col-md-6 mb-4">
        <div class="card border-success border-3 rounded-4 shadow-lg h-100">
            <div class="card-body p-4">
                <h6 class="card-title fw-bold mb-3">
                    <i class="bi bi-lightbulb text-warning fs-4"></i> Glowing Skills
                </h6>
                <ul class="list-unstyled mb-0" id="glowingSkills">
                    <li class="mb-2 fw-semibold">• Skill 1 name</li>
                    <li class="mb-2 fw-semibold">• Skill 2 name</li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card border-danger border-3 rounded-4 shadow-lg h-100">
            <div class="card-body p-4">
                <h6 class="card-title fw-bold mb-3">
                    <i class="bi bi-exclamation-triangle text-danger fs-4"></i> Growing Skills
                </h6>
                <ul class="list-unstyled mb-0" id="growingSkills">
                    <li class="mb-2 fw-semibold">• Skill 1 name</li>
                    <li class="mb-2 fw-semibold">• Skill 2 name</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Chart Section -->
<div class="row mb-5">
    <div class="col-12">
        <div class="card border-3 rounded-4 shadow-lg">
            <div class="card-body p-5">
                <h4 class="card-title text-center fw-bold mb-5">Average Student Scores in Different Domains</h4>
                <div class="chart-container bg-light rounded-4 p-4" style="position: relative; height:450px;">
                    <canvas id="domainChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Student List Section -->
<div class="row">
    <div class="col-12">
        <div class="card border-3 rounded-4 shadow-lg">
            <div class="card-body p-5">
                <div class="row mb-4">
                    <div class="col-md-4">
                        <label for="studentFilter" class="form-label fw-bold">Student:</label>
                        <div class="position-relative">
                            <input type="text" class="form-control form-control-lg border-warning border-3 rounded-4" id="studentFilter" placeholder="Type to search students..." autocomplete="off">
                            <div class="dropdown-menu w-100 border-2 rounded-3 shadow-lg" id="studentDropdown" style="max-height: 200px; overflow-y: auto;"></div>
                            <input type="hidden" id="selectedStudent" name="selectedStudent">
                        </div>
                    </div>
                </div>
                <div class="table-responsive">
                    <div class="border border-2 rounded-4 p-5 text-center text-muted bg-light">
                        <p class="mb-0 fs-5">Student list and their score per domain in different columns (can be scrolled to view all student data)</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// All JS logic should be modular and concise. See README for API integration details.
</script>
{% endblock %}